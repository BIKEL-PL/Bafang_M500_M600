<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>S32 SDK: 07. MTPNV and ID</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top" style="height:auto; width:100%"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <img id="projectlogo" style="height:auto; width:100%" alt="Logo" src="s32sdk_logo_small.jpg"/>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__mtpnvr.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">07. MTPNV and ID<div class="ingroups"><a class="el" href="group__sbc__uja113x.html">System Basis Chip library (SBC) - UJA113x Family</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2>Integration guideline</h2>
<h3>Compilation units</h3>
<p>The following files need to be compiled in the project: </p><pre class="fragment">${S32SDK_PATH}\middleware\sbc\sbc_uja113x\source\sbc_uja113x.c
</pre><h3>Include path</h3>
<p>The following paths need to be added to the include path of the toolchain: </p><pre class="fragment">${S32SDK_PATH}\middleware\sbc\sbc_uja113x\include
</pre><h3>Compile symbols</h3>
<p>No special symbols are required for this component</p>
<h3>Dependencies</h3>
<p><a class="el" href="group__lpspi.html">Low Power Serial Peripheral Interface (LPSPI)</a> <a class="el" href="group__osif.html">OS Interface (OSIF)</a></p>
<h1><a class="anchor" id="mtpnv_intro"></a>
Introduction</h1>
<p>The UJA113x devices incorporate non-volatile memory for SBC configuration. This memory is not reset during off state and influences the chip behavior: </p><ul>
<li>
Register 0x71 <ul>
<li>
HVIOs high-side driver control </li>
</ul>
</li>
<li>
Register 0x72 <ul>
<li>
HVIOs low-side driver control </li>
</ul>
</li>
<li>
Register 0x73 <ul>
<li>
Reset pulse width </li>
<li>
V2 regulator start-up </li>
<li>
HVIO 4 - 2 mode </li>
</ul>
</li>
<li>
Register 0x74 <ul>
<li>
V1 reset threshold at start-up </li>
<li>
FNMC mode/debug feature control </li>
<li>
SDMC mode/debug feature control </li>
<li>
VEXTAC pin </li>
<li>
Sleep mode activation </li>
</ul>
</li>
</ul>
<p>During SW development, to simplify the application debugging, the FNMC and SDMC modes can be used to (partially) disable the Watchdog. In production, the FNMC and SDMC should be disabled to have always full Watchdog functionality present! However, it could be demanding to restore the MTPNV back to factory settings (FNMC enabled) and configure the MTPNV paramters again, but this time with SDMC mode enabled for diagnostics purposes. Or simply enable debug feature by configuring the watchdog into autonomous mode.<br />
Once a UJA113X device has been registered, the <a class="el" href="group__mtpnvr.html#gad516dfc6d852db8395d2e7ff51bec810" title="Writes the non-volitile memory parameters (0x71 - 0x75) of SBC. ">UJA113X_SetMtpnv()</a> can be invoked. This function is called with the parameter set of parameters to be programmed into the non-volatile memory.<br />
This allows the user to define production parameters with FNMC &amp; SDMC disabled and in case of need to enable it again without the need of reflashing the host MCU with some debug firmware.<br />
</p>
<h2><a class="anchor" id="mtpnv_restore"></a>
Restoring MTPNV factory preset values</h2>
<p>The values are restored when following conditions apply for at least td(MTPNV) during power-up: </p><ul>
<li>
pin RSTN is held LOW </li>
<li>
CANH is pulled up to Vbat </li>
<li>
CANL is pulled down to GND </li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Restoring the devices MTPNV back to factory preset values is not supported by the library and it's the users responsibility to implement this feature either in SW or HW. </dd></dl>
<h2><a class="anchor" id="mtpnv_debug"></a>
MTPNV debug flow control</h2>
<p>To have the possibility to enable debugging features (through SDMC mode and watchdog autonomous mode) but keep the MCUs firmware untouched, an MTPNV control sequence depicted on the following figure is recommended: </p><div class="image">
<img src="mtpnv_flow.png" alt="mtpnv_flow.png"/>
<div class="caption">
MTPNV handling</div></div>
<p> This mechanism allows to partially or completely disable the watchdog if required without the need of flashing a custom firmware into the host MCU. In case the MTPNV has been already programmed or it's not allowed by the application to clear the MTPNV, it's still possible to switch the watchdog mode into autonomous, which keeps the watchdog enabled only in normal mode.<br />
 </p><dl class="section note"><dt>Note</dt><dd>If it's requested to set the SDMC mode, the MTPNV has to be restored prior to the above procedure (not depicted in the diagram).</dd></dl>
<p>The idea is: </p><ul>
<li>
Reprogramming the MTPNV to enable SDMC <ul>
<li>
1. Restore factory settings of MTPNV (as described earlier) </li>
<li>
2. Program the MTPVN with SDMC enabled </li>
<li>
3. Depending on situation switch the watchdog mode to autonomous </li>
<li>
4. The watchdog is disabled all the time </li>
</ul>
</li>
<li>
Keep the MTPNV untouched (SDMC disabled) and partially disable watchdog <ul>
<li>
1. Switch the Watchdog mode to autonomous </li>
<li>
2. Watchdog disabled in all other modes then normal (in case there are no pending interrupts) </li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>See <a class="el" href="group__wtdcconfig.html">02. Watchdog</a> section for more details on watchdog behaviour under different circumstances</dd></dl>
<h2><a class="anchor" id="mtpnv_example"></a>
Example</h2>
<p>This example demonstrates one of many possible implemetnatations.<br />
</p><div class="fragment"><div class="line">.</div>
<div class="line">.</div>
<div class="line"><span class="comment">/* Define the MTPNV parameters */</span></div>
<div class="line"><a class="code" href="structuja113x__mtpnv__cfg__t.html">uja113x_mtpnv_cfg_t</a> mtpnvConfig = </div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* highSideCtrl */</span></div>
<div class="line">    <a class="code" href="group__mtpnvhsc__group.html#ga80b4874783fc25f072ba225c2163b56a">HHSDC_IO8HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#ga931fd222f843d6d17e431ec4c3cba787">HHSDC_IO7HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#ga011f096aaf0b264041feb216fa2021e5">HHSDC_IO6HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#gad95a60c64db2abee0e1765d5b7c502e7">HHSDC_IO5HOC_DISABLED</a> | </div>
<div class="line">    <a class="code" href="group__mtpnvhsc__group.html#gac268851661fc19519f779effa417a377">HHSDC_IO4HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#gaddafd9ee3f7998612b1021083707fde1">HHSDC_IO3HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#ga68722a6015ea79a5cd80ed62e433a628">HHSDC_IO2HOC_DISABLED</a> | <a class="code" href="group__mtpnvhsc__group.html#gadb137370343872fd8a7ce36eee320c21">HHSDC_IO1HOC_DISABLED</a>,</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* lowSideCtrl */</span></div>
<div class="line">    <a class="code" href="group__mtpnvlsc__group.html#ga4251a3ba6b8213d22c96f71f8c5c0442">HLSDC_IO8LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#gaae3ee328f066fb8a5d7d918fc856ff46">HLSDC_IO7LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#ga92ab23db321557bbea9b014288024717">HLSDC_IO6LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#gaa00951fd3f31c10414665a1c43f44e66">HLSDC_IO5LOC_DISABLED</a> | </div>
<div class="line">    <a class="code" href="group__mtpnvlsc__group.html#ga4de27d930d0759f0c9567d99e033107c">HLSDC_IO4LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#gaf287adb120e49e9bc49a566aceff8e79">HLSDC_IO3LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#ga67947a4d6da0545609ef6e32ada653f7">HLSDC_IO2LOC_DISABLED</a> | <a class="code" href="group__mtpnvlsc__group.html#gacdf7785b6d4a602c6efd9ffe44860bad">HLSDC_IO1LOC_DISABLED</a>,</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* startupCtrl */</span></div>
<div class="line">    <a class="code" href="group__mtpnvsuc__group.html#ga370fdd4be0ed843f24ded0f2c722abc8">RLC_PULSE_WIDTH_10_12_MS</a> | <a class="code" href="group__mtpnvsuc__group.html#ga976b5a2127018914334aacbbf3f6eb55">V2SUC_ALWAYS_ON</a> | <a class="code" href="group__mtpnvsuc__group.html#gabe48078e7131acb49c6fd62a9f7e28a6">IO4SFC_STD_IO</a> | <a class="code" href="group__mtpnvsuc__group.html#ga41eb18a46a91e7b43b67b098d8038ebd">IO3SFC_STD_IO</a> | <a class="code" href="group__mtpnvsuc__group.html#ga85728817d9e5f4e9ac3d8aba95f9f4a6">IO2SFC_LIMP_HOME</a>,</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* sbcConfigCtrl */</span></div>
<div class="line">    <a class="code" href="group__mtpnvsbccc__group.html#ga7394994cf5b5fd8c50766475864370da">V1RTSUC_90_NOM</a> | <a class="code" href="group__mtpnvsbccc__group.html#gac27d45990dc8ad50b12ecbfdbaa009c1">FNMC_DISABLE</a> | <a class="code" href="group__mtpnvsbccc__group.html#gab568acc9f04d785a7ff22ffa71481487">SDMC_ENABLE</a> | <a class="code" href="group__mtpnvsbccc__group.html#ga0603644fbd598dd4c768f3475ee5cf5e">VEXTAC_SENSOR_SUPPLY</a> | <a class="code" href="group__mtpnvsbccc__group.html#gaba4078b6890241832fc293ba0f60197e">SLPC_SLEEP_SUPPORTED</a></div>
<div class="line">}</div>
<div class="line">.</div>
<div class="line">.</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define SBC0    0U</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> main (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Initialize the MCU - clock, peripherals etc. */</span></div>
<div class="line">    ...</div>
<div class="line">    <span class="comment">/* Initialize the SPI periheral for SBC */</span></div>
<div class="line">    ...</div>
<div class="line">    <span class="comment">/* Initialize the SBC */</span></div>
<div class="line">    <a class="code" href="structuja113x__drv__cfg__t.html">uja113x_drv_cfg_t</a> sbcConfig = </div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__internals.html#gga15f88d82d722430ed46f8a347c099861af8ab44ff485203c63a3a976667123ebe">UJA1132HW5V0</a>, <span class="comment">/* chipType */</span></div>
<div class="line">        0U,           <span class="comment">/* SPI instance */</span></div>
<div class="line">        100U,         <span class="comment">/* SPI timeout */</span></div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__internals.html#ga5e997f4a44718555b139c48a5868f0bd">UJA113X_RegisterDevice</a>(SBC0, &amp;sbcConfig);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">bool</span> enable_debug_mode = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> set_debug         = <span class="keyword">false</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> (1U)</div>
<div class="line">    {</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Set enable_debug_mode and set_debug using some event over</span></div>
<div class="line"><span class="comment">         * CAN/LIN/USART etc. or GPIO inputs - application specific</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        ...</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">true</span> == enable_debug_mode)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">/* Read the NVMPS status bit - UJA113X_SbcTransfer() can be used */</span></div>
<div class="line">            ...</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (1U == NVMPS)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">/* Programm the MTPNV */</span></div>
<div class="line">                <a class="code" href="group__mtpnvr.html#gad516dfc6d852db8395d2e7ff51bec810">UJA113X_SetMtpnv</a>(SBC0, mtpnvConfig);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">true</span> == set_debug)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">/* Set Watchdog into autonomous mode - UJA113X_SetWatchdog() can be used */</span></div>
<div class="line">                    ...</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">/* Set Watchdog into application defined mode - UJA113X_SetWatchdog() can be used*/</span></div>
<div class="line">                    ...</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="mtpnv_crc"></a>
CRC calculation on MTPNV data</h2>
<p>To confirm MTPNV write, last byte written into the SBC (register 0x75) has to be a CRC-8 computed over the written bytes (4 bytes!). This is handled automatically by the <a class="el" href="group__mtpnvr.html#gad516dfc6d852db8395d2e7ff51bec810" title="Writes the non-volitile memory parameters (0x71 - 0x75) of SBC. ">UJA113X_SetMtpnv()</a>. However if the user wants to implemet his own programming procedure, the CRC function is available, see <a class="el" href="group__mtpnvr.html#ga3563d7fbd11f2d2b0153b1f75391d6fb" title="Generic function for CRC8 computation. ">UJA113X_ComputeCrc8()</a> for details. </p>
<dl class="section note"><dt>Note</dt><dd>During CRC computation for devices with partial/none HVIO's the respective bits in registers 0x71 &amp; 0x72 should be considered as 0 even when set by user to 1! </dd></dl>
<h2><a class="anchor" id="did"></a>
Device ID</h2>
<p>Although, there is no dedicated function for reading the devices ID, the <a class="el" href="group__internals.html#gafe11e5f51c35197f40f17b1dfa413151" title="Initiates a write/read operation to/from SBC. ">UJA113X_SbcTransfer()</a> can be used to read the ID registers (0x7E &amp; 0x7F). </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__mtpnvhsc__group"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvhsc__group.html">HVIO high-side configuration options (0x71)</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__mtpnvlsc__group"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvlsc__group.html">HVIO low-side configuration options (0x72)</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__mtpnvsbccc__group"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvsbccc__group.html">SBC configuration control options (0x74)</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__mtpnvsuc__group"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvsuc__group.html">Start-up control configuration options (0x73)</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structuja113x__mtpnv__cfg__t.html">uja113x_mtpnv_cfg_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MTPNV registers configuration structure (0x71 - 0x74)  <a href="structuja113x__mtpnv__cfg__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrc__spec__t.html">crc_spec_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the CRC8 algoritm to be used.  <a href="structcrc__spec__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad516dfc6d852db8395d2e7ff51bec810"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status_8h.html#af9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvr.html#gad516dfc6d852db8395d2e7ff51bec810">UJA113X_SetMtpnv</a> (uint32_t instance, const <a class="el" href="structuja113x__mtpnv__cfg__t.html">uja113x_mtpnv_cfg_t</a> *mtpnvConfig)</td></tr>
<tr class="memdesc:gad516dfc6d852db8395d2e7ff51bec810"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the non-volitile memory parameters (0x71 - 0x75) of SBC.  <a href="#gad516dfc6d852db8395d2e7ff51bec810">More...</a><br /></td></tr>
<tr class="separator:gad516dfc6d852db8395d2e7ff51bec810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3563d7fbd11f2d2b0153b1f75391d6fb"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mtpnvr.html#ga3563d7fbd11f2d2b0153b1f75391d6fb">UJA113X_ComputeCrc8</a> (const <a class="el" href="structcrc__spec__t.html">crc_spec_t</a> *crcDesc, const uint8_t *data, uint8_t <a class="el" href="flash__driver_8c.html#a00050bb8eed2c8a86ac60d9625cae18c">size</a>)</td></tr>
<tr class="memdesc:ga3563d7fbd11f2d2b0153b1f75391d6fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic function for CRC8 computation.  <a href="#ga3563d7fbd11f2d2b0153b1f75391d6fb">More...</a><br /></td></tr>
<tr class="separator:ga3563d7fbd11f2d2b0153b1f75391d6fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga3563d7fbd11f2d2b0153b1f75391d6fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t UJA113X_ComputeCrc8 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcrc__spec__t.html">crc_spec_t</a> *&#160;</td>
          <td class="paramname"><em>crcDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic function for CRC8 computation. </p>
<p>The CRC algorithm is defined by <code><a class="el" href="structcrc__spec__t.html" title="Defines the CRC8 algoritm to be used. ">crc_spec_t</a></code> input parameter, which holds all the relevant information for CRC8 computation. A brute force mechanism is used instead of table driven.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">crcDesc</td><td>Pointer to CRC8 algorithm description </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Array of data over which CRC should be calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Size of array in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Computed CRC8 over <code>data</code> described by <code>crcDesc</code> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>For subsequent calls the CRC from previous computation should be used as initial seed.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The refIn and refOut values have no influence on the computation! The functionality is not implemented yet! </dd></dl>

</div>
</div>
<a class="anchor" id="gad516dfc6d852db8395d2e7ff51bec810"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status_8h.html#af9bff8ff1154a04a899276af806b8586">status_t</a> UJA113X_SetMtpnv </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>instance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structuja113x__mtpnv__cfg__t.html">uja113x_mtpnv_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>mtpnvConfig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the non-volitile memory parameters (0x71 - 0x75) of SBC. </p>
<p>The function prepares a frame based on input configuration parameters and initiates SPI communication in blocking mode. On successful transmission the first byte is verified. In case of a mismatch the MTPNV configuration registers have not been written properly and the process has to be repeated. In case a mismatch happens on CRC write, the outcome can be recognized by reading out the MTPNV registers, reading the MTPNV status bit and an SBC reset in case of success.<br />
<br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">instance</td><td>Index of SBC to configure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mtpnvConfig</td><td>Parameters to be loaded into SBC</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>STATUS_SUCCESS Configuration successful STATUS_BUSY SPI perihperal is busy STATUS_TIMEOUT SPI communication timed out, configuration aborted SBC_CMD_ERROR First received byte doesn't match the repeated address,</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The CRC value is calculated by the function. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>During CRC computation for devices with partial/none HVIO's the respective bits in registers 0x71 &amp; 0x72 should be considered as 0 even when set by user to 1! The function checks the chipType registered with <a class="el" href="group__internals.html#ga5e997f4a44718555b139c48a5868f0bd" title="Registers SBC internal parameters. ">UJA113X_RegisterDevice()</a> and cleares these bits for the purpose of CRC computation. </dd></dl>

<p>Definition at line <a class="el" href="sbc__uja113x_8c_source.html#l01091">1091</a> of file <a class="el" href="sbc__uja113x_8c_source.html">sbc_uja113x.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jun 11 2021 08:16:08 for S32 SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
